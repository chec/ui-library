import { Meta, Props, Story, Preview } from '@storybook/addon-docs/blocks';
import { action } from "@storybook/addon-actions";
import { text, select, boolean, withKnobs } from '@storybook/addon-knobs';
import BaseAlert from '../../components/BaseAlert.vue';
import ChecIcon from '../../components/ChecIcon.vue';

<Meta title="Components/Alert" component={BaseAlert} />

# Alert

<Props of={BaseAlert} />

<Preview>
  <Story name="Default">
    {{
      components: {
        BaseAlert,
        ChecIcon,
      },
      data() {
        return {
          closed: false,
        };
      },
      methods: {
        close() {
          setTimeout(() => this.closed = false, 3000);
          this.closed = true;
          return action('Alert closed!')();
        }
      },
      props: {
        variant: {
          default: select('Variant', ['success', 'error', 'warning', 'info']),
        },
        text: {
          default: text('Text to Alert', 'Text to alert!'),
        },
        showIcon: {
          default: boolean('Show Icon', false),
        },
        disableClose: {
          default: boolean('Disable Close Button', false),
        },
      },
      template: `
        <div class="mx-auto px-16 pt-6">
          <BaseAlert
            v-show="!closed"
            :variant="variant"
            :disable-close="disableClose"
            @close="close()"
          >
            <ChecIcon v-if="showIcon" icon="chec"/>
            Text to Alert!
          </BaseAlert>
        </div>`
    }}
  </Story>
</Preview>

# Variants

<Preview>
  <Story name="Variants">
    {{
      components: {
        BaseAlert
      },
      data() {
        return {
          variants: ['success', 'error', 'warning', 'info'],
          closed: [],
        };
      },
      methods: {
        close(variant) {
          if (!this.isClosed(variant)) {
            this.closed.push(variant);
            setTimeout(() => {
              this.closed.splice(this.closed.indexOf(variant), 1);
            }, 3000)
          }
        },
        isClosed(variant) {
          return this.closed.includes(variant);
        },
        content(variant) {
          return `${variant.substring(0, 1).toUpperCase()}${variant.substring(1)} variant`;
        }
      },
      template: `
        <div class="mx-auto px-16 pt-6">
          <BaseAlert
            v-for="variant in variants"
            v-show="!isClosed(variant)"
            class="my-6"
            :variant="variant"
            @close="close(variant)"
          >
            {{content(variant)}}
          </BaseAlert>
        </div>`
    }}
  </Story>
</Preview>

# Inline Variants

<Preview>
  <Story name="Inline Variants">
    {{
      components: {
        BaseAlert,
        ChecIcon,
      },
      data() {
        return {
          variants: ['success', 'error', 'warning', 'info'],
          closed: [],
        };
      },
      methods: {
        close(variant) {
          if (!this.isClosed(variant)) {
            this.closed.push(variant);
            setTimeout(() => {
              this.closed.splice(this.closed.indexOf(variant), 1);
            }, 3000)
          }
        },
        isClosed(variant) {
          return this.closed.includes(variant);
        },
        content(variant) {
          return `${variant.substring(0, 1).toUpperCase()}${variant.substring(1)} variant`;
        },
        icon(variant) {
          if (variant == 'success') {
            return 'check-square';
          }
          if (variant == 'error') {
            return 'close-square';
          }
          if (variant == 'warning') {
            return 'exclamation-square';
          }
          if (variant == 'info') {
            return 'info-square';
          }
          return 'info-square';
        }
      },
      props: {
        showIcon: {
          default: boolean('Show Icon', true),
        },
        disableClose: {
          default: boolean('Disable Close Button', true),
        },
      },
      template: `
        <div class="mx-auto px-16 pt-6">
          <BaseAlert
            v-for="variant in variants"
            v-show="!isClosed(variant)"
            class="my-6"
            :variant="variant"
            :inline="true"
            :disable-close="disableClose"
            @close="close(variant)"
          >
            <ChecIcon v-if="showIcon" :icon="icon(variant)"/>
            {{content(variant)}}
          </BaseAlert>
        </div>`
    }}
  </Story>
</Preview>
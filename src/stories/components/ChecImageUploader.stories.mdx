import { Meta, Props, Story, Preview } from '@storybook/addon-docs/blocks';
import { action } from '@storybook/addon-actions';
import { withKnobs, text, boolean } from '@storybook/addon-knobs';
import ChecImageUploader from '../../components/ChecImageUploader.vue';
import ImageBlock from '../../components/ChecImageUploader/ImageBlock.vue';

<Meta title="Form fields/Image Uploader" component={ChecImageUploader} />

# Dropdown

<details>

</details>

<Props of={ChecImageUploader} />

# Default:

<Preview>
  <Story name="Default">
    {{
      components: {
        ChecImageUploader,
      },
      data() {
        return {
          files: {},
        };
      },
      props: {
        endpoint: {
          default: text('endpoint', 'https://httpbin.org/post'),
        },
      },
      methods: {
        addedFile(file) {
          action('added-file');
          this.files = { ...this.files, [file.upload.uuid]: file };
        },
        removeFile(file) {
          action('remove-file');
          if (file.upload.progress < 100 && file.status !== 'error') {
            return;
          }
          const files = { ...this.files };
          delete files[file.upload.uuid];
          this.files = { ...files };
        },
        uploadingFile(file) {
          action('uploading-file');
          this.files = { ...this.files, [file.upload.uuid]: file };
        },
       uploadingFileComplete(file) {
          action('uploading-file-complete');
          this.files = { ...this.files, [file.upload.uuid]: file };
        },
      },
      template: `
        <div class="p-16 flex justify-center w-full h-full bg-white py-20">
          <ChecImageUploader
            :files="Object.values(files)"
            @file-added="addedFile"
            @remove-file="removeFile"
            @file-uploading="uploadingFile"
            @file-uploading-complete="uploadingFileComplete"
            :endpoint="endpoint"
          />
        </div>`
    }}
  </Story>
</Preview>


# File row

<Preview>
  <Story name="ImageBlock">
    {{
      components: {
        ImageBlock,
      },
      props: {
        error: {
          default: boolean('error', false)
        },
        loading: {
          default: boolean('loading', false)
        },
      },
      methods: {
        removeFileEvent: action('remove-file'),
      },
      template: `
        <div class="p-16 flex justify-center w-full h-full bg-white py-20">
          <ImageBlock
            :loading="loading"
            :error="error"
            @remove-file="removeFileEvent"
          />
        </div>`
    }}
  </Story>
</Preview>

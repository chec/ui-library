import { Meta, Props, Story, Preview } from '@storybook/addon-docs/blocks';
import { action } from "@storybook/addon-actions";
import { text, select } from '@storybook/addon-knobs';
import BaseNotification from '../../components/BaseNotification.vue';

<Meta title="Components/Notifications" component={BaseNotification} />

# Notification

<Props of={BaseNotification} />

<Preview>
  <Story name="Default">
    {{
      components: {
        BaseNotification
      },
      data() {
        return {
          closed: false,
        };
      },
      methods: {
        close() {
          setTimeout(() => this.closed = false, 3000);
          this.closed = true;
          return action('Notification closed!')();
        }
      },
      props: {
        variant: {
          default: select('Variant', ['success', 'error', 'warning', 'info']),
        },
        text: {
          default: text('Text to Notification', 'An alert!'),
        },
      },
      template: `
        <div class="mx-auto max-w-lg pt-6">
          <BaseNotification
            v-if="!closed"
            :variant="variant"
            @closet="close()"
            :autoHide="false"
          >
            {{text}}
          </BaseNotification>
        </div>`
    }}
  </Story>
</Preview>

# Variants

<Preview>
  <Story name="Variants">
    {{
      components: {
        BaseNotification
      },
      data() {
        return {
          variants: ['success', 'error', 'warning', 'info'],
          closed: [],
        };
      },
      methods: {
        close(variant) {
          if (!this.isClosed(variant)) {
            this.closed.push(variant);
            setTimeout(() => {
              this.closed.splice(this.closed.indexOf(variant), 1);
            }, 3000)
          }
        },
        isClosed(variant) {
          return this.closed.includes(variant);
        },
        content(variant) {
          return `${variant.substring(0, 1).toUpperCase()}${variant.substring(1)} variant`;
        }
      },
      template: `
        <div class="mx-auto max-w-lg pt-6">
          <BaseNotification
            v-for="variant in variants"
            v-if="!isClosed(variant)"
            class="mb-2"
            :variant="variant"
            @close="close(variant)"
            :autoHide="false"
          >
            {{content(variant)}}
          </BaseNotification>
        </div>`
    }}
  </Story>
</Preview>

# Format alert text using a default slot:

<Preview>
  <Story name="Formatted alert text">
    {{
      components: {
        BaseNotification
      },
      data() {
        return {
          closed: false,
        };
      },
      methods: {
        close() {
          setTimeout(() => this.closed = false, 3000);
          this.closed = true;
          return action('Notification closed!')();
        }
      },
      props: {
        variant: {
          default: select('Variant', ['success', 'error', 'warning', 'info']),
        },
      },
      template: `
        <div class="mx-auto max-w-lg pt-6">
          <BaseNotification
            v-if="!closed"
            :variant="variant"
            @close="close()"
            :autoHide="false"
          >
            <p class="font-bold text-red-200 text-xs italic">
              Formatted alert text.
            </p>
          </BaseNotification>
        </div>`
    }}
  </Story>
</Preview>

# Automatically hide on a timer

<Preview>
  <Story name="Hide on timer">
    {{
      components: {
        BaseNotification
      },
      data() {
        return {
          closed: false,
        };
      },
      methods: {
        close() {
          setTimeout(() => this.closed = false, 3000);
          this.closed = true;
          return action('Notification timer expired and was it was hidden')();
        }
      },
      props: {
        variant: {
          default: select('Variant', ['success', 'error', 'warning', 'info']),
        },
      },
      template: `
        <div class="mx-auto max-w-lg pt-6">
          <BaseNotification
            v-if="!closed"
            :variant="variant"
            @close="close()"
            :hideTime="3000"
            autoHide
          >
            I will disappear after 3 seconds
          </BaseNotification>
        </div>`
    }}
  </Story>
</Preview>
